/**
 * EdgeMetadataPanel -- Rich edge sidebar styles
 *
 * Design philosophy: Stark Biome tokens with meaningful confidence coloring.
 * "Evidence over intuition. Traces over reflexes."
 */

/* =============================================================================
   CSS Variables
   ============================================================================= */

.edge-metadata-panel {
  /* Confidence colors */
  --color-confidence-high: #4caf50;   /* Green - high confidence */
  --color-confidence-medium: #ff9800; /* Amber - medium confidence */
  --color-confidence-low: #f44336;    /* Red - low confidence */
  --color-confidence-unknown: #9e9e9e; /* Gray - unknown */

  /* Edge type accent colors */
  --color-derives: #8b5cf6;     /* Purple - derivation (Zero Seed) */
  --color-implements: #4caf50;  /* Green - implementation */
  --color-tests: #4a9eff;       /* Blue - tests */
  --color-references: #9e9e9e;  /* Gray - generic reference */
  --color-contradicts: #f44336; /* Red - conflict */
  --color-extends: #ff9800;     /* Orange - inheritance */
  --color-contains: #0891b2;    /* Cyan - containment */
  --color-uses: #6366f1;        /* Indigo - dependency */
  --color-defines: #ec4899;     /* Pink - definition */

  /* Surface colors (Stark Biome) */
  --panel-bg: var(--steel-900, #1a1a1a);
  --panel-border: var(--steel-800, #252525);
  --surface-hover: var(--steel-800, #252525);
  --text-primary: var(--steel-100, #e0e0e0);
  --text-secondary: var(--steel-400, #888);
  --text-tertiary: var(--steel-500, #666);
}

/* =============================================================================
   Panel Container
   ============================================================================= */

.edge-metadata-panel {
  position: relative;
  display: flex;
  flex-direction: column;
  background: var(--panel-bg);
  border-left: 1px solid var(--panel-border);
  font-size: 0.8125rem;
  transition: width 0.2s ease;
  z-index: 10;
}

.edge-metadata-panel--open {
  width: 280px;
  min-width: 280px;
}

.edge-metadata-panel--closed {
  width: 40px;
  min-width: 40px;
  overflow: hidden;
}

.edge-metadata-panel--closed .edge-metadata-panel__content {
  opacity: 0;
  pointer-events: none;
}

/* =============================================================================
   Toggle Button
   ============================================================================= */

.edge-metadata-panel__toggle {
  position: absolute;
  top: 0;
  left: 0;
  width: 40px;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0.25rem;
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  z-index: 10;
  transition: color 0.15s ease, background-color 0.15s ease;
}

.edge-metadata-panel__toggle:hover {
  color: var(--text-primary);
  background: var(--surface-hover);
}

.edge-metadata-panel__toggle:focus {
  outline: none;
}

.edge-metadata-panel__toggle:focus-visible {
  outline: 2px solid var(--color-confidence-high);
  outline-offset: -2px;
}

.edge-metadata-panel__toggle-icon {
  font-size: 14px;
  font-family: var(--font-mono, 'JetBrains Mono', monospace);
  transition: transform 0.2s ease;
}

.edge-metadata-panel__toggle-label {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  opacity: 0.7;
}

.edge-metadata-panel__toggle-count {
  writing-mode: vertical-rl;
  font-size: 10px;
  font-weight: 600;
  color: var(--color-confidence-high);
  margin-top: 0.25rem;
}

.edge-metadata-panel--closed .edge-metadata-panel__toggle-label {
  opacity: 1;
}

/* =============================================================================
   Panel Content
   ============================================================================= */

.edge-metadata-panel__content {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 0.75rem;
  padding-left: calc(40px + 0.75rem);
  overflow-y: auto;
  flex: 1;
  transition: opacity 0.15s ease;
}

/* =============================================================================
   Header
   ============================================================================= */

.edge-metadata-panel__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--panel-border);
}

.edge-metadata-panel__title {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
}

.edge-metadata-panel__total {
  font-size: 0.6875rem;
  color: var(--text-tertiary);
}

/* =============================================================================
   Legend
   ============================================================================= */

.edge-metadata-panel__legend {
  display: flex;
  gap: 0.5rem;
  font-size: 0.625rem;
  color: var(--text-tertiary);
}

.edge-metadata-panel__legend-item {
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

.edge-metadata-panel__legend-item::before {
  content: '';
  width: 8px;
  height: 8px;
  border-radius: 2px;
}

.edge-metadata-panel__legend-item--high::before {
  background: var(--color-confidence-high);
}

.edge-metadata-panel__legend-item--medium::before {
  background: var(--color-confidence-medium);
}

.edge-metadata-panel__legend-item--low::before {
  background: var(--color-confidence-low);
}

/* =============================================================================
   Section (Incoming / Outgoing)
   ============================================================================= */

.edge-metadata-panel__section {
  display: flex;
  flex-direction: column;
  gap: 0.375rem;
}

.edge-metadata-panel__section-title {
  display: flex;
  align-items: center;
  gap: 0.375rem;
  font-size: 0.6875rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-tertiary);
  margin: 0;
}

.edge-metadata-panel__section-count {
  font-weight: 400;
  color: var(--text-tertiary);
}

.edge-metadata-panel__empty {
  font-size: 0.75rem;
  color: var(--text-tertiary);
  font-style: italic;
  margin: 0;
  padding: 0.375rem 0;
}

/* =============================================================================
   Edge Type Group
   ============================================================================= */

.edge-metadata-panel__group {
  border: 1px solid var(--panel-border);
  border-radius: 4px;
  overflow: hidden;
}

/* Type-specific left border colors */
.edge-metadata-panel__group--derives_from {
  border-left: 3px solid var(--color-derives);
}

.edge-metadata-panel__group--implements {
  border-left: 3px solid var(--color-implements);
}

.edge-metadata-panel__group--tests {
  border-left: 3px solid var(--color-tests);
}

.edge-metadata-panel__group--references {
  border-left: 3px solid var(--color-references);
}

.edge-metadata-panel__group--contradicts {
  border-left: 3px solid var(--color-contradicts);
}

.edge-metadata-panel__group--extends {
  border-left: 3px solid var(--color-extends);
}

.edge-metadata-panel__group--contains {
  border-left: 3px solid var(--color-contains);
}

.edge-metadata-panel__group--uses {
  border-left: 3px solid var(--color-uses);
}

.edge-metadata-panel__group--defines {
  border-left: 3px solid var(--color-defines);
}

.edge-metadata-panel__group-header {
  display: flex;
  align-items: center;
  gap: 0.375rem;
  width: 100%;
  padding: 0.375rem 0.5rem;
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 0.75rem;
  font-family: inherit;
  text-align: left;
  transition: background 0.15s ease;
}

.edge-metadata-panel__group-header:hover {
  background: var(--surface-hover);
}

.edge-metadata-panel__group-icon {
  font-family: var(--font-mono, 'JetBrains Mono', monospace);
  font-size: 0.625rem;
  font-weight: 600;
  opacity: 0.6;
  min-width: 1.25rem;
}

.edge-metadata-panel__group-label {
  flex: 1;
  font-weight: 500;
  color: var(--text-primary);
}

.edge-metadata-panel__group-count {
  font-size: 0.625rem;
  color: var(--text-tertiary);
  background: var(--panel-border);
  padding: 0.125rem 0.375rem;
  border-radius: 10px;
}

.edge-metadata-panel__group-witness {
  color: #8b4513;
  font-weight: 600;
  font-size: 0.75rem;
}

.edge-metadata-panel__group-confidence {
  font-size: 0.625rem;
  font-weight: 500;
  padding: 0.125rem 0.25rem;
  border-radius: 2px;
}

.edge-metadata-panel__group-confidence--high {
  color: var(--color-confidence-high);
}

.edge-metadata-panel__group-confidence--medium {
  color: var(--color-confidence-medium);
}

.edge-metadata-panel__group-confidence--low {
  color: var(--color-confidence-low);
}

.edge-metadata-panel__group-confidence--unknown {
  color: var(--color-confidence-unknown);
}

.edge-metadata-panel__group-toggle {
  font-family: var(--font-mono, 'JetBrains Mono', monospace);
  font-size: 0.75rem;
  color: var(--text-tertiary);
}

.edge-metadata-panel__group-content {
  display: flex;
  flex-direction: column;
  border-top: 1px solid var(--panel-border);
}

/* =============================================================================
   Individual Edge Item
   ============================================================================= */

.edge-metadata-panel__edge {
  display: flex;
  flex-direction: column;
  gap: 0.125rem;
  width: 100%;
  padding: 0.5rem;
  background: transparent;
  border: none;
  border-left: 3px solid transparent;
  cursor: pointer;
  font-family: inherit;
  text-align: left;
  transition: background 0.15s ease, border-color 0.15s ease;
}

.edge-metadata-panel__edge + .edge-metadata-panel__edge {
  border-top: 1px solid var(--panel-border);
}

.edge-metadata-panel__edge:hover {
  background: var(--surface-hover);
}

/* Confidence-based left border */
.edge-metadata-panel__edge--high {
  border-left-color: var(--color-confidence-high);
}

.edge-metadata-panel__edge--medium {
  border-left-color: var(--color-confidence-medium);
}

.edge-metadata-panel__edge--low {
  border-left-color: var(--color-confidence-low);
}

.edge-metadata-panel__edge--unknown {
  border-left-color: var(--color-confidence-unknown);
}

.edge-metadata-panel__edge-main {
  display: flex;
  align-items: center;
  gap: 0.375rem;
}

.edge-metadata-panel__edge-name {
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--text-primary);
}

.edge-metadata-panel__witness-mark {
  color: #8b4513;
  font-weight: 600;
  font-size: 0.75rem;
  title: 'Has witness mark';
}

.edge-metadata-panel__edge-meta {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.6875rem;
}

.edge-metadata-panel__confidence {
  font-weight: 500;
  padding: 0.0625rem 0.25rem;
  border-radius: 2px;
  background: rgba(0, 0, 0, 0.2);
}

.edge-metadata-panel__confidence--high {
  color: var(--color-confidence-high);
}

.edge-metadata-panel__confidence--medium {
  color: var(--color-confidence-medium);
}

.edge-metadata-panel__confidence--low {
  color: var(--color-confidence-low);
}

.edge-metadata-panel__confidence--unknown {
  color: var(--color-confidence-unknown);
}

.edge-metadata-panel__origin {
  color: var(--text-tertiary);
  font-size: 0.625rem;
  text-transform: uppercase;
  letter-spacing: 0.03em;
}

.edge-metadata-panel__edge-path {
  font-size: 0.625rem;
  color: var(--text-tertiary);
  font-family: var(--font-mono, 'JetBrains Mono', monospace);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.edge-metadata-panel__edge-context {
  font-size: 0.6875rem;
  color: var(--text-secondary);
  font-style: italic;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-top: 0.125rem;
}

/* =============================================================================
   Hint Footer
   ============================================================================= */

.edge-metadata-panel__hint {
  margin-top: auto;
  padding-top: 0.5rem;
  border-top: 1px solid var(--panel-border);
  font-size: 0.625rem;
  color: var(--text-tertiary);
  text-align: center;
}

.edge-metadata-panel__hint kbd {
  display: inline-block;
  padding: 0.125rem 0.25rem;
  background: var(--panel-border);
  border: 1px solid var(--steel-700, #333);
  border-radius: 2px;
  font-family: inherit;
  font-size: 0.625rem;
  color: var(--text-secondary);
}

/* =============================================================================
   Responsive
   ============================================================================= */

@media (max-width: 768px) {
  .edge-metadata-panel--open {
    width: 240px;
    min-width: 240px;
  }

  .edge-metadata-panel__edge {
    padding: 0.375rem;
  }

  .edge-metadata-panel__edge-name {
    font-size: 0.75rem;
  }
}
