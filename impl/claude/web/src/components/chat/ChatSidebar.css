/**
 * ChatSidebar â€” Enhanced ChatPanel styling for sidebar use
 *
 * BRUTALIST CLARITY + UX LAWS
 * - 90% steel, 10% earned glow
 * - Glow on input focus ONLY (earned through use)
 * - Unread indicator (red dot, not decorative)
 * - Vim-inspired minimalism
 *
 * The Workspace handles sidebar chrome (toggle, header).
 * This CSS adds chat-specific enhancements.
 *
 * @see docs/UX-LAWS.md
 */

/* =============================================================================
   Container
   ============================================================================= */

.chat-sidebar {
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* ChatPanel container (full height) */
.chat-sidebar__panel {
  flex: 1;
  overflow: hidden;
}

/* =============================================================================
   Branch Controls (compact mode)
   ============================================================================= */

/* Branch controls in sidebar header */
.chat-sidebar__branch-controls {
  padding: 4px 8px;
  border-bottom: 1px solid var(--steel-800, #27272a);
  flex-shrink: 0;
}

/* Compact mode for BranchControls in sidebar */
.chat-sidebar__branch-controls .branch-controls {
  flex-wrap: wrap;
  gap: 4px;
}

.chat-sidebar__branch-controls .branch-controls__button {
  padding: 4px 8px;
  font-size: 12px;
}

/* =============================================================================
   Unread Indicator (earned glow)
   ============================================================================= */

.chat-sidebar__unread-badge {
  position: absolute;
  top: 8px;
  right: 8px;
  z-index: 10;
  pointer-events: none;
}

.chat-sidebar__unread-dot {
  display: block;
  width: 8px;
  height: 8px;
  background: var(--error-500, #ef4444);
  border-radius: 50%;
  box-shadow: 0 0 4px var(--error-500, #ef4444);
  animation: pulse-subtle 2s ease-in-out infinite;
}

@keyframes pulse-subtle {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

/* =============================================================================
   Earned Glow (ONLY on input focus - per UX-LAWS.md)
   ============================================================================= */

/* Target the input area when focused (earned glow) */
.chat-sidebar .chat-panel__input:has(:focus-visible) {
  box-shadow: 0 -2px 8px rgba(59, 130, 246, 0.15);
  border-top-color: var(--focus-ring, #3b82f6);
  transition: box-shadow 0.2s ease, border-color 0.2s ease;
}

/* Success glow after message sent (earned) */
.chat-sidebar .chat-panel__input:has(.input-area--success) {
  box-shadow: 0 -2px 8px rgba(34, 197, 94, 0.15);
  border-top-color: var(--success-500, #22c55e);
  animation: success-flash 0.6s ease-out;
}

@keyframes success-flash {
  0% {
    box-shadow: 0 -2px 8px rgba(34, 197, 94, 0.3);
  }
  100% {
    box-shadow: 0 -2px 8px rgba(34, 197, 94, 0.15);
  }
}

/* =============================================================================
   Compact Mode Optimizations
   ============================================================================= */

/* Tighter spacing for sidebar use */
.chat-sidebar .chat-panel__messages {
  padding: 6px;
}

/* Slim context indicator (if shown) */
.chat-sidebar .chat-panel__context {
  padding: 4px 8px;
  font-size: 11px;
}

/* Compact mutation acknowledgments */
.chat-sidebar .chat-panel__mutations {
  padding: 4px 6px;
  gap: 2px;
}

/* =============================================================================
   Accessibility
   ============================================================================= */

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  .chat-sidebar__unread-dot {
    animation: none;
  }

  .chat-sidebar .chat-panel__input:has(.input-area--success) {
    animation: none;
  }
}

/* =============================================================================
   Responsive
   ============================================================================= */

@media (max-width: 768px) {
  /* Even tighter on mobile */
  .chat-sidebar .chat-panel__messages {
    padding: 4px;
  }

  .chat-sidebar__unread-badge {
    top: 4px;
    right: 4px;
  }

  .chat-sidebar__unread-dot {
    width: 6px;
    height: 6px;
  }
}
