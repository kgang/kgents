/**
 * FusionCeremony Styles
 *
 * STARK BIOME aesthetic: 90% steel, 10% earned glow.
 * "The frame is humble. The content glows."
 *
 * Color Semantics:
 * - Kent (thesis): warm accent (amber/spore)
 * - Claude (antithesis): cool accent (cyan/blue)
 * - Synthesis: earned glow (purple/violet - the fusion of warm + cool)
 *
 * Design Philosophy:
 * - Brutalist containers, sharp frames
 * - Minimal animation (not gaudy)
 * - Information-dense but breathable
 */

/* =============================================================================
   Layout: Main Ceremony Container
   ============================================================================= */

.fusion-ceremony {
  display: flex;
  flex-direction: column;
  gap: var(--space-lg, 1.25rem);
  padding: var(--space-lg, 1.25rem);
  background: var(--surface-0, #0a0a0c);
  min-height: 100%;
  font-family: var(--font-mono, 'JetBrains Mono', monospace);
}

.fusion-ceremony__header {
  text-align: center;
  padding: var(--space-md, 0.85rem) 0;
  border-bottom: 1px solid var(--surface-3, #28282f);
}

.fusion-ceremony__title {
  font-size: var(--font-size-xl, 1.5rem);
  font-weight: var(--font-weight-semibold, 600);
  color: var(--text-primary, #e5e7eb);
  letter-spacing: 0.05em;
  text-transform: uppercase;
  margin: 0 0 var(--space-xs, 0.2rem) 0;
}

.fusion-ceremony__subtitle {
  font-size: var(--font-size-sm, 0.75rem);
  color: var(--text-muted, #5a5a64);
  margin: 0;
}

/* =============================================================================
   Cocone Visualization Area
   ============================================================================= */

.fusion-ceremony__cocone {
  display: flex;
  justify-content: center;
  padding: var(--space-md, 0.85rem);
}

/* =============================================================================
   Three-Panel Layout
   ============================================================================= */

.fusion-ceremony__panels {
  display: grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  gap: var(--space-md, 0.85rem);
  flex: 1;
  min-height: 300px;
}

/* Responsive: Stack on smaller screens */
@media (max-width: 1024px) {
  .fusion-ceremony__panels {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto auto;
  }

  .fusion-ceremony__panels > :nth-child(2) {
    grid-column: span 2;
    order: 3;
  }
}

@media (max-width: 768px) {
  .fusion-ceremony__panels {
    grid-template-columns: 1fr;
  }

  .fusion-ceremony__panels > :nth-child(2) {
    grid-column: 1;
    order: 3;
  }
}

/* =============================================================================
   Panel Base Styles
   ============================================================================= */

.fusion-panel {
  display: flex;
  flex-direction: column;
  background: var(--surface-1, #141418);
  border: 1px solid var(--surface-3, #28282f);
  border-radius: var(--radius-bare, 2px);
  overflow: hidden;
}

.fusion-panel__header {
  display: flex;
  align-items: center;
  gap: var(--space-sm, 0.4rem);
  padding: var(--space-sm, 0.4rem) var(--space-md, 0.85rem);
  background: var(--surface-2, #1c1c22);
  border-bottom: 1px solid var(--surface-3, #28282f);
}

.fusion-panel__badge {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: var(--radius-subtle, 3px);
  font-size: var(--font-size-sm, 0.75rem);
  font-weight: var(--font-weight-bold, 700);
  color: var(--surface-0, #0a0a0c);
}

.fusion-panel__badge--kent {
  background: var(--color-glow-spore, #c4a77d);
}

.fusion-panel__badge--claude {
  background: #4a9eff;
}

.fusion-panel__badge--synthesis {
  background: var(--status-visual, #9c27b0);
}

.fusion-panel__title {
  font-size: var(--font-size-sm, 0.75rem);
  font-weight: var(--font-weight-semibold, 600);
  color: var(--text-primary, #e5e7eb);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin: 0;
}

.fusion-panel__subtitle {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  margin-left: auto;
}

.fusion-panel__content {
  flex: 1;
  padding: var(--space-md, 0.85rem);
  overflow-y: auto;
}

.fusion-panel__footer {
  padding: var(--space-sm, 0.4rem) var(--space-md, 0.85rem);
  border-top: 1px solid var(--surface-3, #28282f);
  background: var(--surface-2, #1c1c22);
}

.fusion-panel__hint {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  font-style: italic;
}

/* =============================================================================
   Panel Variants
   ============================================================================= */

/* Thesis (Kent) - warm accent */
.fusion-panel--thesis {
  border-color: rgba(196, 167, 125, 0.2);
}

.fusion-panel--thesis .fusion-panel__header {
  border-bottom-color: rgba(196, 167, 125, 0.2);
}

/* Antithesis (Claude) - cool accent */
.fusion-panel--antithesis {
  border-color: rgba(74, 158, 255, 0.2);
}

.fusion-panel--antithesis .fusion-panel__header {
  border-bottom-color: rgba(74, 158, 255, 0.2);
}

/* Synthesis - purple (fusion of warm + cool) */
.fusion-panel--synthesis {
  border-color: rgba(156, 39, 176, 0.2);
}

.fusion-panel--synthesis .fusion-panel__header {
  border-bottom-color: rgba(156, 39, 176, 0.2);
}

.fusion-panel--synthesis.fusion-panel--complete {
  border-color: rgba(156, 39, 176, 0.5);
  box-shadow: 0 0 20px rgba(156, 39, 176, 0.1);
}

/* =============================================================================
   Form Fields
   ============================================================================= */

.fusion-field {
  display: flex;
  flex-direction: column;
  gap: var(--space-xs, 0.2rem);
  margin-bottom: var(--space-md, 0.85rem);
}

.fusion-field:last-child {
  margin-bottom: 0;
}

.fusion-field__label {
  font-size: var(--font-size-xs, 0.625rem);
  font-weight: var(--font-weight-semibold, 600);
  color: var(--text-muted, #5a5a64);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.fusion-field__input,
.fusion-field__textarea {
  width: 100%;
  padding: var(--space-sm, 0.4rem) var(--space-md, 0.85rem);
  background: var(--surface-0, #0a0a0c);
  border: 1px solid var(--surface-3, #28282f);
  border-radius: var(--radius-bare, 2px);
  color: var(--text-primary, #e5e7eb);
  font-family: inherit;
  font-size: var(--font-size-sm, 0.75rem);
  line-height: 1.5;
  transition: border-color var(--duration-fast, 120ms) var(--ease-out, cubic-bezier(0, 0, 0.2, 1));
}

.fusion-field__input:focus,
.fusion-field__textarea:focus {
  outline: none;
  border-color: var(--text-secondary, #8a8a94);
}

.fusion-field__input::placeholder,
.fusion-field__textarea::placeholder {
  color: var(--text-muted, #5a5a64);
}

.fusion-field__input:disabled,
.fusion-field__textarea:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.fusion-field__textarea {
  resize: vertical;
  min-height: 80px;
}

.fusion-field__textarea--small {
  min-height: 60px;
}

/* Field prompt (suggestion) */
.fusion-field__prompt {
  display: flex;
  align-items: flex-start;
  gap: var(--space-xs, 0.2rem);
  padding: var(--space-xs, 0.2rem);
  background: rgba(74, 158, 255, 0.05);
  border-radius: var(--radius-bare, 2px);
  margin-top: var(--space-xs, 0.2rem);
}

.fusion-field__prompt-icon {
  flex-shrink: 0;
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(74, 158, 255, 0.2);
  border-radius: var(--radius-pill, 9999px);
  font-size: var(--font-size-xs, 0.625rem);
  font-weight: var(--font-weight-bold, 700);
  color: #4a9eff;
}

.fusion-field__prompt-text {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-secondary, #8a8a94);
}

/* =============================================================================
   Synthesis Panel Content
   ============================================================================= */

/* Skeleton loading */
.fusion-synthesis__skeleton {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-xl, 1.75rem);
  text-align: center;
}

.fusion-synthesis__skeleton-pulse {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-pill, 9999px);
  background: var(--status-visual, #9c27b0);
  animation: synthesis-pulse 1.5s ease-in-out infinite;
  margin-bottom: var(--space-md, 0.85rem);
}

@keyframes synthesis-pulse {
  0%,
  100% {
    opacity: 0.3;
    transform: scale(1);
  }
  50% {
    opacity: 0.8;
    transform: scale(1.1);
  }
}

.fusion-synthesis__skeleton-text {
  font-size: var(--font-size-sm, 0.75rem);
  color: var(--text-secondary, #8a8a94);
}

.fusion-synthesis__skeleton-subtitle {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  margin-top: var(--space-xs, 0.2rem);
}

/* Empty state */
.fusion-synthesis__empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-xl, 1.75rem);
  text-align: center;
}

.fusion-synthesis__empty-icon {
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px dashed var(--surface-3, #28282f);
  border-radius: var(--radius-pill, 9999px);
  font-size: var(--font-size-xl, 1.5rem);
  color: var(--text-muted, #5a5a64);
  margin-bottom: var(--space-md, 0.85rem);
}

.fusion-synthesis__empty-text {
  font-size: var(--font-size-sm, 0.75rem);
  color: var(--text-secondary, #8a8a94);
}

.fusion-synthesis__empty-subtitle {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  margin-top: var(--space-xs, 0.2rem);
}

/* Result badge */
.fusion-result-badge {
  display: flex;
  align-items: center;
  gap: var(--space-xs, 0.2rem);
  padding: 2px 8px;
  border-radius: var(--radius-pill, 9999px);
  font-size: var(--font-size-xs, 0.625rem);
  font-weight: var(--font-weight-semibold, 600);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-left: auto;
}

.fusion-result-badge__icon {
  font-weight: var(--font-weight-bold, 700);
}

.fusion-result--consensus {
  background: rgba(34, 197, 94, 0.2);
  color: #22c55e;
}

.fusion-result--synthesis {
  background: rgba(156, 39, 176, 0.2);
  color: #ba68c8;
}

.fusion-result--kent {
  background: rgba(196, 167, 125, 0.2);
  color: var(--color-glow-spore, #c4a77d);
}

.fusion-result--claude {
  background: rgba(74, 158, 255, 0.2);
  color: #4a9eff;
}

.fusion-result--deferred {
  background: rgba(107, 114, 128, 0.2);
  color: #9ca3af;
}

.fusion-result--veto {
  background: rgba(239, 68, 68, 0.2);
  color: #ef4444;
}

/* Trust delta */
.fusion-trust-delta {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-sm, 0.4rem) var(--space-md, 0.85rem);
  background: var(--surface-2, #1c1c22);
  border-radius: var(--radius-bare, 2px);
  margin-bottom: var(--space-md, 0.85rem);
}

.fusion-trust-delta__label {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.fusion-trust-delta__value {
  font-size: var(--font-size-sm, 0.75rem);
  font-weight: var(--font-weight-bold, 700);
}

.trust-delta--positive .fusion-trust-delta__value {
  color: #22c55e;
}

.trust-delta--negative .fusion-trust-delta__value {
  color: #ef4444;
}

.trust-delta--neutral .fusion-trust-delta__value {
  color: var(--text-muted, #5a5a64);
}

/* Synthesis blocks */
.fusion-synthesis-block {
  margin-bottom: var(--space-md, 0.85rem);
}

.fusion-synthesis-block:last-child {
  margin-bottom: 0;
}

.fusion-synthesis-block__label {
  font-size: var(--font-size-xs, 0.625rem);
  font-weight: var(--font-weight-semibold, 600);
  color: var(--text-muted, #5a5a64);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: var(--space-xs, 0.2rem);
}

.fusion-synthesis-block__content {
  font-size: var(--font-size-sm, 0.75rem);
  color: var(--text-primary, #e5e7eb);
  line-height: 1.6;
}

.fusion-synthesis-block--main {
  padding: var(--space-md, 0.85rem);
  background: rgba(156, 39, 176, 0.08);
  border-left: 3px solid var(--status-visual, #9c27b0);
  border-radius: var(--radius-bare, 2px);
}

.fusion-synthesis-block--transcends {
  padding: var(--space-sm, 0.4rem) var(--space-md, 0.85rem);
  background: rgba(156, 39, 176, 0.05);
  border-radius: var(--radius-bare, 2px);
}

/* Preservation section */
.fusion-preservation {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm, 0.4rem);
  margin-bottom: var(--space-md, 0.85rem);
}

.fusion-preservation__item {
  display: flex;
  align-items: flex-start;
  gap: var(--space-sm, 0.4rem);
  padding: var(--space-sm, 0.4rem);
  background: var(--surface-2, #1c1c22);
  border-radius: var(--radius-bare, 2px);
}

.fusion-preservation__badge {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-subtle, 3px);
  font-size: var(--font-size-xs, 0.625rem);
  font-weight: var(--font-weight-bold, 700);
  color: var(--surface-0, #0a0a0c);
}

.fusion-preservation__item--kent .fusion-preservation__badge {
  background: var(--color-glow-spore, #c4a77d);
}

.fusion-preservation__item--claude .fusion-preservation__badge {
  background: #4a9eff;
}

.fusion-preservation__content {
  flex: 1;
}

.fusion-preservation__label {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  margin-bottom: 2px;
}

.fusion-preservation__text {
  font-size: var(--font-size-sm, 0.75rem);
  color: var(--text-secondary, #8a8a94);
}

/* =============================================================================
   Cocone Visualization
   ============================================================================= */

.cocone-visualization {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-sm, 0.4rem);
}

.cocone-svg {
  width: 200px;
  height: 160px;
}

.cocone-label {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Cocone nodes */
.cocone-node__circle {
  fill: var(--surface-2, #1c1c22);
  stroke: var(--surface-3, #28282f);
  stroke-width: 1;
  transition: all var(--duration-normal, 200ms) var(--ease-out, cubic-bezier(0, 0, 0.2, 1));
}

.cocone-node__circle--filled {
  fill: var(--surface-3, #28282f);
}

.cocone-node__glow {
  fill: transparent;
  opacity: 0.3;
}

.cocone-node__label {
  font-size: 10px;
  font-weight: 700;
  fill: var(--text-muted, #5a5a64);
  font-family: var(--font-mono);
}

/* Node variants */
.cocone-node--thesis.cocone-node--active .cocone-node__circle {
  stroke: var(--color-glow-spore, #c4a77d);
  stroke-width: 2;
}

.cocone-node--thesis.cocone-node--active .cocone-node__glow {
  fill: var(--color-glow-spore, #c4a77d);
}

.cocone-node--thesis.cocone-node--active .cocone-node__label {
  fill: var(--color-glow-spore, #c4a77d);
}

.cocone-node--antithesis.cocone-node--active .cocone-node__circle {
  stroke: #4a9eff;
  stroke-width: 2;
}

.cocone-node--antithesis.cocone-node--active .cocone-node__glow {
  fill: #4a9eff;
}

.cocone-node--antithesis.cocone-node--active .cocone-node__label {
  fill: #4a9eff;
}

.cocone-node--synthesis.cocone-node--active .cocone-node__circle {
  stroke: var(--status-visual, #9c27b0);
  stroke-width: 2;
  fill: rgba(156, 39, 176, 0.2);
}

.cocone-node--synthesis.cocone-node--active .cocone-node__glow {
  fill: var(--status-visual, #9c27b0);
  animation: synthesis-node-glow 2s ease-in-out infinite;
}

.cocone-node--synthesis.cocone-node--active .cocone-node__label {
  fill: var(--status-visual, #9c27b0);
}

@keyframes synthesis-node-glow {
  0%,
  100% {
    opacity: 0.2;
  }
  50% {
    opacity: 0.5;
  }
}

/* Cocone legs (morphisms) */
.cocone-leg {
  stroke: var(--surface-3, #28282f);
  transition: all var(--duration-normal, 200ms) var(--ease-out, cubic-bezier(0, 0, 0.2, 1));
}

.cocone-leg--active {
  stroke: var(--status-visual, #9c27b0);
}

/* Cocone base line */
.cocone-base {
  stroke: var(--surface-3, #28282f);
  stroke-width: 1;
  stroke-dasharray: 4 4;
  transition: all var(--duration-normal, 200ms) var(--ease-out, cubic-bezier(0, 0, 0.2, 1));
}

.cocone-base--active {
  stroke: var(--text-muted, #5a5a64);
  stroke-dasharray: none;
}

/* Cocone arrows */
.cocone-arrow {
  fill: var(--surface-3, #28282f);
}

.cocone-arrow--active {
  fill: var(--status-visual, #9c27b0);
}

/* =============================================================================
   Buttons
   ============================================================================= */

.fusion-button {
  padding: var(--space-sm, 0.4rem) var(--space-lg, 1.25rem);
  background: var(--surface-2, #1c1c22);
  border: 1px solid var(--surface-3, #28282f);
  border-radius: var(--radius-bare, 2px);
  color: var(--text-primary, #e5e7eb);
  font-family: inherit;
  font-size: var(--font-size-sm, 0.75rem);
  font-weight: var(--font-weight-semibold, 600);
  cursor: pointer;
  transition: all var(--duration-fast, 120ms) var(--ease-out, cubic-bezier(0, 0, 0.2, 1));
}

.fusion-button:hover:not(:disabled) {
  background: var(--surface-3, #28282f);
  border-color: var(--text-muted, #5a5a64);
}

.fusion-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.fusion-button--primary {
  background: var(--status-visual, #9c27b0);
  border-color: var(--status-visual, #9c27b0);
  color: white;
}

.fusion-button--primary:hover:not(:disabled) {
  background: #7b1fa2;
  border-color: #7b1fa2;
}

.fusion-button--secondary {
  background: transparent;
  border-color: var(--surface-3, #28282f);
}

.fusion-button--ghost {
  background: transparent;
  border-color: transparent;
  color: var(--text-secondary, #8a8a94);
}

.fusion-button--ghost:hover:not(:disabled) {
  background: var(--surface-2, #1c1c22);
  color: var(--text-primary, #e5e7eb);
}

/* =============================================================================
   Footer & Actions
   ============================================================================= */

.fusion-ceremony__footer {
  display: flex;
  justify-content: center;
  padding: var(--space-md, 0.85rem) 0;
  border-top: 1px solid var(--surface-3, #28282f);
}

.fusion-ceremony__actions {
  display: flex;
  align-items: center;
  gap: var(--space-md, 0.85rem);
}

.fusion-ceremony__actions--complete {
  justify-content: space-between;
  width: 100%;
  max-width: 500px;
}

.fusion-ceremony__export {
  display: flex;
  gap: var(--space-sm, 0.4rem);
}

.fusion-ceremony__hint {
  font-size: var(--font-size-xs, 0.625rem);
  color: var(--text-muted, #5a5a64);
}

.fusion-ceremony__hint kbd {
  display: inline-block;
  padding: 2px 6px;
  background: var(--surface-2, #1c1c22);
  border: 1px solid var(--surface-3, #28282f);
  border-radius: var(--radius-bare, 2px);
  font-family: inherit;
  font-size: var(--font-size-xs, 0.625rem);
}

/* =============================================================================
   Meta Information
   ============================================================================= */

.fusion-ceremony__meta {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-sm, 0.4rem);
  padding: var(--space-sm, 0.4rem);
  font-size: var(--font-size-xs, 0.625rem);
}

.fusion-ceremony__meta-label {
  color: var(--text-muted, #5a5a64);
}

.fusion-ceremony__meta-value {
  color: var(--text-secondary, #8a8a94);
  background: var(--surface-2, #1c1c22);
  padding: 2px 6px;
  border-radius: var(--radius-bare, 2px);
}

.fusion-ceremony__meta-separator {
  color: var(--surface-3, #28282f);
}

/* =============================================================================
   Error Display
   ============================================================================= */

.fusion-ceremony__error {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-sm, 0.4rem);
  padding: var(--space-md, 0.85rem);
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: var(--radius-bare, 2px);
}

.fusion-ceremony__error-icon {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #ef4444;
  border-radius: var(--radius-pill, 9999px);
  font-size: var(--font-size-xs, 0.625rem);
  font-weight: var(--font-weight-bold, 700);
  color: white;
}

.fusion-ceremony__error-text {
  font-size: var(--font-size-sm, 0.75rem);
  color: #ef4444;
}

/* =============================================================================
   Phase-Specific States
   ============================================================================= */

.fusion-ceremony[data-phase='processing'] .fusion-ceremony__panels {
  pointer-events: none;
}

.fusion-ceremony[data-phase='complete'] .fusion-panel--thesis,
.fusion-ceremony[data-phase='complete'] .fusion-panel--antithesis {
  opacity: 0.8;
}

/* =============================================================================
   Reduced Motion
   ============================================================================= */

@media (prefers-reduced-motion: reduce) {
  .fusion-synthesis__skeleton-pulse,
  .cocone-node__glow {
    animation: none;
  }

  .cocone-leg,
  .cocone-node__circle,
  .fusion-field__input,
  .fusion-field__textarea,
  .fusion-button {
    transition: none;
  }
}
