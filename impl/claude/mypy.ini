# mypy configuration
# Strict mode with targeted relaxations for external deps and test files

[mypy]
strict = True
explicit_package_bases = True
# Exclude archived directories, generated code, and non-Python package dirs
exclude = (?x)(
    ^activate/
    | .*-archived.*
    | .*/_archived/.*
    | .*/_generated/.*
    | ^terrarium-archived/
  )

# =============================================================================
# EXTERNAL LIBRARIES (no type stubs)
# =============================================================================
# Using glob patterns to reduce repetition

[mypy-redis.*]
ignore_missing_imports = True

[mypy-fakeredis.*]
ignore_missing_imports = True

[mypy-asyncpg.*]
ignore_missing_imports = True

[mypy-lark.*]
ignore_missing_imports = True

[mypy-sentence_transformers.*]
ignore_missing_imports = True

[mypy-openai.*]
ignore_missing_imports = True

[mypy-chromadb.*]
ignore_missing_imports = True

[mypy-faiss.*]
ignore_missing_imports = True

[mypy-dspy.*]
ignore_missing_imports = True

[mypy-uvicorn.*]
ignore_missing_imports = True

[mypy-fastapi.*]
ignore_missing_imports = True

[mypy-textual.*]
ignore_missing_imports = True

[mypy-rich.*]
ignore_missing_imports = True

[mypy-grpc.*]
ignore_missing_imports = True

[mypy-grpcio.*]
ignore_missing_imports = True

[mypy-grpcio_tools.*]
ignore_missing_imports = True

[mypy-kopf.*]
ignore_missing_imports = True

[mypy-kubernetes.*]
ignore_missing_imports = True

[mypy-kubernetes_asyncio.*]
ignore_missing_imports = True

[mypy-yaml.*]
ignore_missing_imports = True

[mypy-hypothesis.*]
ignore_missing_imports = True

[mypy-prometheus_client.*]
ignore_missing_imports = True

[mypy-google.*]
ignore_missing_imports = True

[mypy-qdrant_client.*]
ignore_missing_imports = True

[mypy-watchdog.*]
ignore_missing_imports = True

[mypy-opentelemetry.*]
ignore_missing_imports = True

[mypy-websockets.*]
ignore_missing_imports = True

[mypy-stripe.*]
ignore_missing_imports = True

[mypy-stripe.error]
ignore_missing_imports = True

[mypy-marimo.*]
ignore_missing_imports = True

[mypy-alembic.*]
ignore_missing_imports = True

[mypy-nats.*]
ignore_missing_imports = True

[mypy-anywidget.*]
ignore_missing_imports = True

[mypy-traitlets.*]
ignore_missing_imports = True

[mypy-IPython.*]
ignore_missing_imports = True

# =============================================================================
# MODULES WITH UNTYPED EXTERNAL DECORATORS
# =============================================================================
# FastAPI and kopf decorators are untyped, so we relax decorator strictness

[mypy-agents.w.server]
disallow_untyped_decorators = False
warn_unused_ignores = False

[mypy-protocols.terrarium.gateway]
disallow_untyped_decorators = False
warn_unused_ignores = False

# K8s operators use kopf decorators which have complex type signatures
# We ignore errors in these modules to allow flexibility in handler signatures
[mypy-infra.k8s.operators.agent_operator]
ignore_errors = True

[mypy-infra.k8s.operators.proposal_operator]
ignore_errors = True

[mypy-infra.k8s.operators.pheromone_operator]
ignore_errors = True

[mypy-protocols.agentese.jit]
warn_unused_ignores = False

# =============================================================================
# GENERATED CODE (skip entirely)
# =============================================================================

[mypy-protocols.proto.generated.*]
ignore_errors = True

# =============================================================================
# INTERNAL WIP MODULES
# =============================================================================

[mypy-impl.*]
ignore_missing_imports = True

[mypy-shared]
ignore_errors = True

[mypy-shared.*]
ignore_missing_imports = True

[mypy-agents.d.transform_agent]
ignore_missing_imports = True

[mypy-agents.d.bicameral]
ignore_missing_imports = True

[mypy-agents.d.modal_scope]
ignore_missing_imports = True

[mypy-agents.e.parser.p_integration]
ignore_missing_imports = True

[mypy-agents.m.compaction]
ignore_missing_imports = True

[mypy-agents.m.crystallization_integration]
ignore_missing_imports = True

[mypy-agents.town.ui.*]
ignore_missing_imports = True

[mypy-protocols.cli.companions]
ignore_missing_imports = True

[mypy-protocols.cli.igent_synergy]
ignore_missing_imports = True

[mypy-protocols.cli.scientific]
ignore_missing_imports = True

# CLI handlers/contexts with WIP/deleted module imports
[mypy-protocols.cli.handlers.tether]
ignore_errors = True

[mypy-protocols.cli.handlers.dev]
ignore_errors = True

[mypy-protocols.cli.handlers.prompt]
ignore_errors = True

[mypy-protocols.cli.handlers.daemon]
ignore_errors = True

[mypy-protocols.cli.handlers.flinch]
ignore_errors = True

[mypy-protocols.cli.handlers.play]
ignore_errors = True

[mypy-protocols.cli.instance_db.*]
ignore_errors = True

[mypy-protocols.cli.contexts.concept]
ignore_errors = True

[mypy-protocols.cli.contexts.self_]
ignore_errors = True

[mypy-protocols.cli.contexts.time_]
ignore_errors = True

[mypy-protocols.cli.contexts.void]
ignore_errors = True

[mypy-protocols.cli.glass]
ignore_errors = True

[mypy-protocols.cli.repl]
ignore_errors = True

[mypy-protocols.prompt.compiler]
ignore_missing_imports = True

[mypy-protocols.prompt.cli]
ignore_missing_imports = True

# Prompt modules referencing deleted compiler - transitional
[mypy-protocols.prompt.sources.*]
ignore_errors = True

[mypy-protocols.prompt.rollback.*]
ignore_errors = True

[mypy-protocols.prompt.soft_section]
ignore_errors = True

[mypy-protocols.prompt.section_base]
ignore_errors = True

[mypy-protocols.prompt.metrics.*]
ignore_errors = True

# Archived/WIP UI modules
[mypy-agents.town._archive_ui.*]
ignore_errors = True

[mypy-agents.town.server]
ignore_errors = True

[mypy-protocols.api.atelier]
ignore_missing_imports = True

[mypy-protocols.api.town]
ignore_missing_imports = True

[mypy-infra.k8s.*]
ignore_missing_imports = True

[mypy-__main__.*]
ignore_missing_imports = True

# Polynomial functors (WIP - experimental typing)
[mypy-agents.poly.*]
ignore_errors = True

[mypy-agents.operad.*]
ignore_errors = True

# =============================================================================
# TEST FILES (relaxed strictness)
# =============================================================================
# Mypy globs: * matches one level, so we need patterns for each depth
# Test files get relaxed checking for fixtures, decorators, and dynamic typing
# We disable common error codes that are low-value in test code:
#   - no-untyped-def: Test functions often don't need return types
#   - arg-type: Mock objects and fixtures often have flexible types
#   - attr-defined: Tests access internal/private attributes
#   - var-annotated: Test variables often inferred
#   - union-attr: Tests work with optional types liberally

[mypy-conftest]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr

# Top-level test modules
[mypy-testing]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr

[mypy-testing.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr

[mypy-qa]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr

[mypy-qa.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, no-any-return, import-untyped

# _tests at depth 1: agents._tests, shared._tests, etc.
[mypy-*._tests]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

[mypy-*._tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

# _tests at depth 2: agents.a._tests, protocols.cli._tests, etc.
[mypy-*.*._tests]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

[mypy-*.*._tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

# _tests at depth 3: protocols.cli.flow._tests, infra.k8s.operators._tests, etc.
[mypy-*.*.*._tests]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

[mypy-*.*.*._tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

# _tests at depth 4: protocols.cli.instance_db._tests, etc.
[mypy-*.*.*.*._tests]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

[mypy-*.*.*.*._tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

# tests/ pattern (non-underscore prefix) for some modules
[mypy-*.tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

[mypy-*.*.tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

[mypy-*.*.*.tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
disallow_untyped_decorators = False
warn_unused_ignores = False
disable_error_code = no-untyped-def, arg-type, attr-defined, var-annotated, union-attr, index, comparison-overlap, misc, operator, type-arg, assignment, return-value, no-any-return, call-arg

# =============================================================================
# HIGH-ERROR PRODUCTION MODULES (pragmatic relaxations)
# =============================================================================
# These modules have consistent patterns of typing issues that are low-value
# to fix individually. Relaxed checking allows them to continue working.

# Forge node has ~49 BasicRendering arg-type issues - intentional pattern
[mypy-services.forge.node]
disable_error_code = arg-type, assignment, override, union-attr

# Forge soul_node - same pattern as forge.node (Observer vs Umwelt override)
[mypy-services.forge.soul_node]
disable_error_code = arg-type, override

# Gallery pilots - UI prototypes with heavy JSON parsing
[mypy-protocols.projection.gallery.pilots]
disable_error_code = no-any-return, arg-type, attr-defined, index

# Memory allocation - complex type inference
[mypy-agents.k.memory_allocation]
disable_error_code = no-any-return, attr-defined, call-arg

# Infrastructure API - optional FastAPI fallbacks
[mypy-protocols.api.infrastructure]
disable_error_code = arg-type, assignment, no-untyped-call, no-untyped-def, misc, no-redef
warn_unused_ignores = False

# Gestalt API - optional FastAPI fallbacks
[mypy-protocols.api.gestalt]
disable_error_code = arg-type, assignment, call-arg, no-untyped-def, no-untyped-call, misc, no-redef
warn_unused_ignores = False

# CLI gardener handler - complex routing
[mypy-protocols.cli.handlers.gardener]
disable_error_code = arg-type, attr-defined, no-any-return, index

# Kubernetes collector - optional k8s imports and async complexity
[mypy-agents.infra.collectors.kubernetes]
disable_error_code = attr-defined, no-any-return, union-attr, type-arg, override, no-untyped-def, no-redef

# Example collaboration modality - demo/prototype code
[mypy-agents.f.modalities.example_collaboration]
disable_error_code = no-any-return, arg-type, no-untyped-def, no-untyped-call, var-annotated

# Vector DB - optional imports for multiple backends
[mypy-agents.l.vector_db]
disable_error_code = attr-defined, assignment, misc, call-arg, union-attr, import-untyped, arg-type, unused-ignore
warn_unused_ignores = False

# Gardener session - complex state machine
[mypy-agents.gardener.session]
disable_error_code = no-any-return, attr-defined, return-value

# Providers - DI container with dynamic types
[mypy-services.providers]
disable_error_code = no-any-return, attr-defined, name-defined

# =============================================================================
# ADDITIONAL PRODUCTION MODULES
# =============================================================================

# Prompt habits - session analysis with complex datetime logic
[mypy-protocols.prompt.habits.session_analyzer]
disable_error_code = arg-type, assignment, operator, list-item, type-arg

# I-gent screens - UI state machines
[mypy-agents.i.screens.*]
disable_error_code = attr-defined, type-arg, no-any-return, import-untyped

# I-gent data providers
[mypy-agents.i.data.*]
disable_error_code = attr-defined, type-arg

# Chat service modules
[mypy-services.chat.*]
disable_error_code = attr-defined, type-arg, no-any-return, arg-type

# CLI gestalt handler
[mypy-protocols.cli.handlers.gestalt]
disable_error_code = no-any-return, arg-type, attr-defined

# Park scenario - game state machine
[mypy-agents.park.scenario]
disable_error_code = no-any-return, assignment

# Gardener logos seasons - temporal logic
[mypy-protocols.gardener_logos.seasons]
disable_error_code = attr-defined, no-any-return, list-item, arg-type

# CLI chat commands
[mypy-protocols.cli.commands.chat.*]
disable_error_code = arg-type, attr-defined

# Infra collectors base
[mypy-agents.infra.collectors.base]
disable_error_code = attr-defined, no-any-return, type-arg, arg-type

# F-gent collaboration modality
[mypy-agents.f.modalities.collaboration]
disable_error_code = no-untyped-def, no-untyped-call, var-annotated, type-arg, assignment

# Town services
[mypy-services.town.*]
disable_error_code = attr-defined, no-any-return

# API gallery
[mypy-protocols.api.gallery]
disable_error_code = misc, no-untyped-def, assignment, attr-defined, union-attr
warn_unused_ignores = False

# AGENTESE contexts
[mypy-protocols.agentese.contexts.prompt]
disable_error_code = arg-type, no-any-return, operator, attr-defined

# Town agents
[mypy-agents.town.*]
disable_error_code = attr-defined, no-any-return

# Atelier modules
[mypy-agents.atelier.*]
disable_error_code = attr-defined, arg-type

# CLI brain handler
[mypy-protocols.cli.handlers.brain]
disable_error_code = no-any-return, arg-type, type-arg

# CLI park handler
[mypy-protocols.cli.handlers.park_thin]
disable_error_code = no-any-return, arg-type, assignment, return-value

# Morpheus service
[mypy-services.morpheus.*]
disable_error_code = attr-defined, no-any-return, no-untyped-def, no-untyped-call

# =============================================================================
# ADDITIONAL RELAXATIONS (2025-12-18)
# =============================================================================

# Services - gardener contracts
[mypy-services.gardener.contracts]
disable_error_code = type-arg

# Memory agent
[mypy-agents.m.memory]
disable_error_code = no-any-return

[mypy-agents.m.importers.markdown]
disable_error_code = typeddict-item, no-any-return

[mypy-agents.m.soul_memory]
disable_error_code = arg-type

# Infra models and health
[mypy-agents.infra.models]
disable_error_code = type-arg

[mypy-agents.infra.health]
disable_error_code = type-arg

# Emergence polynomial
[mypy-agents.emergence.polynomial]
disable_error_code = arg-type

# Prompt habits
[mypy-protocols.prompt.habits.policy]
disable_error_code = type-arg

[mypy-protocols.prompt.habits.code_analyzer]
disable_error_code = arg-type

[mypy-protocols.prompt.habits.encoder]
disable_error_code = assignment

# Forge festival service
[mypy-services.forge.festival_service]
disable_error_code = assignment

# Gallery operad
[mypy-agents.gallery.operad]
disable_error_code = type-arg

# AGENTESE contexts - self_grow
[mypy-protocols.agentese.contexts.self_grow.*]
disable_error_code = arg-type, no-any-return, assignment

# Differance operad
[mypy-agents.differance.operad]
disable_error_code = arg-type, return-value

# Park director
[mypy-agents.park.director]
disable_error_code = no-any-return

# Design generate
[mypy-agents.design.generate]
disable_error_code = attr-defined

# Gestalt reactive
[mypy-protocols.gestalt.reactive]
disable_error_code = return-value

# D-gent backends
[mypy-agents.d.backends.postgres]
disable_error_code = no-any-return

[mypy-agents.d.backends.jsonl]
disable_error_code = union-attr

# Migrations (already have alembic ignore, but add error ignore for env/versions)
[mypy-system.migrations.*]
ignore_errors = True

# D-gent adapters
[mypy-agents.d.adapters.table_adapter]
disable_error_code = no-any-return, redundant-cast

# Atelier economy
[mypy-agents.atelier.economy]
disable_error_code = return-value

[mypy-agents.f.modalities.chat]
disable_error_code = type-arg, assignment

# N-gent store
[mypy-agents.n.dgent_store]
disable_error_code = attr-defined

# SQLAlchemy models - __table_args__ type issues
[mypy-models.town]
disable_error_code = type-arg, assignment

[mypy-models.park]
disable_error_code = type-arg, assignment

[mypy-models.gestalt]
disable_error_code = type-arg, assignment

[mypy-models.gardener]
disable_error_code = assignment

[mypy-models.coalition]
disable_error_code = type-arg, assignment

# CLI modules
[mypy-protocols.cli.help_projector]
disable_error_code = attr-defined, no-any-return

[mypy-protocols.cli.chat_projection]
disable_error_code = arg-type

[mypy-protocols.cli.handlers.park]
disable_error_code = assignment

[mypy-protocols.cli.handlers.atelier]
disable_error_code = assignment

[mypy-protocols.cli.projection]
disable_error_code = attr-defined, no-any-return

[mypy-protocols.cli.handlers.gardener_thin]
disable_error_code = return-value

[mypy-protocols.cli.agentese_router]
disable_error_code = attr-defined

[mypy-protocols.cli.handlers.session]
disable_error_code = assignment

[mypy-protocols.cli.commands.chat.resume]
disable_error_code = arg-type, attr-defined, call-arg, var-annotated

# API modules
[mypy-protocols.api.gardener]
disable_error_code = attr-defined

# Services bootstrap
[mypy-services.bootstrap]
disable_error_code = arg-type

# =============================================================================
# ADDITIONAL RELAXATIONS (2025-12-18 round 2)
# =============================================================================

# Models (SQLAlchemy __table_args__)
[mypy-models.brain]
disable_error_code = type-arg, assignment

[mypy-models.atelier]
disable_error_code = type-arg, assignment

# Dialogue service
[mypy-services.town.dialogue_service]
disable_error_code = assignment

# Projection widgets
[mypy-protocols.projection.widgets.graph]
ignore_missing_imports = True

# TUI base
[mypy-protocols.projection.tui.base]
disable_error_code = no-any-return

# State functor
[mypy-agents.s.state_functor]
disable_error_code = override, no-any-return

# Marimo adapters
[mypy-protocols.projection.marimo.adapters]
ignore_missing_imports = True

# Town demo marimo
[mypy-agents.town.demo_marimo]
disable_error_code = unused-ignore
warn_unused_ignores = False

# World gallery context
[mypy-protocols.agentese.contexts.world_gallery]
disable_error_code = var-annotated, arg-type, override

# Plotext
[mypy-plotext.*]
ignore_missing_imports = True

# Plotly
[mypy-plotly.*]
ignore_missing_imports = True

# API brain
[mypy-protocols.api.brain]
disable_error_code = arg-type, no-untyped-def, call-arg, misc

# Gestalt node
[mypy-services.gestalt.node]
disable_error_code = union-attr

# Park API
[mypy-protocols.api.park]
disable_error_code = arg-type, no-untyped-def, call-arg, misc

# Chat adapter
[mypy-services.chat.adapter]
disable_error_code = override

# Atelier synergy
[mypy-agents.atelier.synergy]
disable_error_code = no-untyped-def, no-untyped-call

# D-gent upgrader
[mypy-agents.d.upgrader]
disable_error_code = type-arg

# Town memory service
[mypy-services.town.memory_service]
disable_error_code = call-arg, assignment

# Park persistence
[mypy-services.park.persistence]
disable_error_code = arg-type

# Town persistent memory
[mypy-agents.town.persistent_memory]
disable_error_code = call-arg, assignment

# Brain node
[mypy-services.brain.node]
disable_error_code = assignment, attr-defined

# L-gent init
[mypy-agents.l.__init__]
ignore_errors = True
disable_error_code = import-untyped

# D-gent - treat as partially typed internal package
# Some submodules don't have py.typed markers
[mypy-agents.d.*]
ignore_missing_imports = True
follow_imports = silent

# =============================================================================
# ADDITIONAL RELAXATIONS (2025-12-18 round 3)
# =============================================================================

# Self-grow contexts
[mypy-protocols.agentese.contexts.self_grow.abuse]
disable_error_code = unused-ignore
warn_unused_ignores = False

[mypy-protocols.agentese.contexts.self_grow.rollback]
disable_error_code = unused-ignore
warn_unused_ignores = False

[mypy-protocols.agentese.contexts.self_grow.promote]
disable_error_code = unused-ignore
warn_unused_ignores = False

[mypy-protocols.agentese.contexts.self_grow.recognize]
disable_error_code = unused-ignore, var-annotated
warn_unused_ignores = False

[mypy-protocols.agentese.contexts.self_grow.duplication]
disable_error_code = unused-ignore
warn_unused_ignores = False

# Chat transformer
[mypy-services.chat.transformer]
disable_error_code = assignment

# Ghost collectors
[mypy-infra.ghost.collectors]
disable_error_code = attr-defined

# Synergy handlers
[mypy-protocols.synergy.handlers.gestalt_garden]
disable_error_code = attr-defined, no-any-return

# Self jewel flow context
[mypy-protocols.agentese.contexts.self_jewel_flow]
disable_error_code = attr-defined

# Self citizen context
[mypy-protocols.agentese.contexts.self_citizen]
disable_error_code = no-any-return

# L-gent vgent adapter
[mypy-agents.l.vgent_adapter]
disable_error_code = arg-type, unused-ignore
warn_unused_ignores = False

# CLI handlers dashboard
[mypy-protocols.cli.handlers.dashboard]
ignore_errors = True

# Ghost collectors (infra.ghost)
[mypy-infra.ghost.*]
disable_error_code = attr-defined

# Self_ context (import-untyped)
[mypy-protocols.agentese.contexts.self_]
disable_error_code = import-untyped

# =============================================================================
# FINAL RELAXATIONS (2025-12-18)
# =============================================================================

# Testcontainers (optional test dependency)
[mypy-testcontainers]
ignore_missing_imports = True

[mypy-testcontainers.*]
ignore_missing_imports = True

# System tests conftest (testcontainers)
[mypy-system._tests.conftest]
disable_error_code = import-not-found

# I-gent reactive tests (import-untyped for d.context_window)
[mypy-agents.i.reactive._tests.*]
disable_error_code = import-untyped

# =============================================================================
# ADDITIONAL RELAXATIONS (2025-12-18 round 4)
# =============================================================================

# Forge commission node - follows forge.node pattern
[mypy-services.forge.commission_node]
disable_error_code = arg-type, assignment, override, union-attr

# Forge commission
[mypy-services.forge.commission]
disable_error_code = arg-type

# Scripts (seed data, utilities)
[mypy-scripts.*]
ignore_errors = True

# World contexts - AGENTESE contexts with various patterns
[mypy-protocols.agentese.contexts.world_gestalt_live]
disable_error_code = misc

[mypy-protocols.agentese.contexts.world_atelier]
disable_error_code = import-untyped

[mypy-protocols.agentese.contexts.world_gallery_api]
disable_error_code = var-annotated, override

[mypy-protocols.agentese.contexts.world_workshop]
disable_error_code = var-annotated, override, misc

[mypy-protocols.agentese.contexts.world_gardener]
disable_error_code = arg-type, override

[mypy-protocols.agentese.contexts.self_system]
disable_error_code = unused-ignore, import-untyped
warn_unused_ignores = False

# Brain persistence
[mypy-services.brain.persistence]
disable_error_code = arg-type, assignment, return-value

# CLI query handler
[mypy-protocols.cli.handlers.query]
disable_error_code = arg-type, import-untyped

# =============================================================================
# ADDITIONAL RELAXATIONS (2025-12-19 - CI compatibility)
# =============================================================================
# These modules have anywidget/traitlets typing that varies between envs

[mypy-agents.i.marimo.widgets.base]
disable_error_code = misc, unused-ignore
warn_unused_ignores = False

[mypy-agents.i.marimo.widgets.dialectic]
disable_error_code = unused-ignore, assignment
warn_unused_ignores = False

[mypy-agents.i.marimo.logos_bridge]
disable_error_code = no-redef

[mypy-agents.i.reactive.adapters.marimo_widget]
disable_error_code = misc, unused-ignore
warn_unused_ignores = False

[mypy-agents.town.telegram_notifier]
disable_error_code = import-not-found, unused-ignore
warn_unused_ignores = False

[mypy-agents.i.reactive.playground]
disable_error_code = no-untyped-call, unused-ignore
warn_unused_ignores = False
