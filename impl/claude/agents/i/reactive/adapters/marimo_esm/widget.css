/**
 * KgentsWidget Styles for anywidget (marimo/Jupyter)
 *
 * Uses CSS variables with fallbacks for theming.
 * Respects marimo's dark/light mode via prefers-color-scheme.
 */

/* Theme variables with marimo-compatible fallbacks */
.kgents-widget {
  --kgents-primary: var(--marimo-accent-color, #3b82f6);
  --kgents-surface: var(--marimo-bg-secondary, #1a1a2e);
  --kgents-surface-border: var(--marimo-border-color, #333344);
  --kgents-text: var(--marimo-text-color, #e0e0e0);
  --kgents-text-muted: var(--marimo-text-muted, #888888);
  --kgents-success: #22c55e;
  --kgents-warning: #eab308;
  --kgents-error: #ef4444;
  --kgents-font-mono: var(--marimo-monospace-font, "Monaco", "Menlo", monospace);

  font-family: var(--kgents-font-mono);
  color: var(--kgents-text);
}

/* Light mode overrides */
@media (prefers-color-scheme: light) {
  .kgents-widget {
    --kgents-surface: var(--marimo-bg-secondary, #f5f5f5);
    --kgents-surface-border: var(--marimo-border-color, #cccccc);
    --kgents-text: var(--marimo-text-color, #1a1a1a);
    --kgents-text-muted: var(--marimo-text-muted, #666666);
  }
}

/* ===== Agent Card ===== */
.kgents-agent-card {
  background: var(--kgents-surface);
  border: 1px solid var(--kgents-surface-border);
  border-radius: 6px;
  padding: 12px;
  min-width: 180px;
  max-width: 300px;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.kgents-agent-card:hover {
  border-color: var(--kgents-primary);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* Phase-specific card styling */
.kgents-agent-card.kgents-phase-active {
  border-left: 3px solid var(--kgents-success);
}

.kgents-agent-card.kgents-phase-error {
  border-left: 3px solid var(--kgents-error);
}

.kgents-agent-card.kgents-phase-waiting {
  border-left: 3px solid var(--kgents-warning);
}

.kgents-agent-card.kgents-phase-idle {
  border-left: 3px solid var(--kgents-text-muted);
}

.kgents-agent-card.kgents-phase-complete {
  border-left: 3px solid var(--kgents-primary);
}

/* Breathing animation for active agents */
.kgents-agent-card.kgents-breathing {
  animation: kgents-breathe 3s ease-in-out infinite;
}

@keyframes kgents-breathe {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.92;
    transform: scale(0.995);
  }
}

.kgents-card-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.kgents-phase-icon {
  font-size: 1.2em;
  line-height: 1;
}

.kgents-agent-name {
  font-weight: 600;
  font-size: 0.95em;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.kgents-card-body {
  margin-bottom: 8px;
  min-height: 24px;
}

.kgents-card-footer {
  font-size: 0.9em;
  opacity: 0.9;
}

/* ===== Sparkline ===== */
.kgents-sparkline {
  display: inline-flex;
  align-items: flex-end;
  height: 24px;
}

.kgents-sparkline-svg {
  width: 100%;
  height: 100%;
  min-width: 80px;
  max-width: 200px;
}

.kgents-sparkline-container {
  display: flex;
  align-items: center;
  gap: 4px;
}

.kgents-sparkline-label {
  color: var(--kgents-text-muted);
  font-size: 0.85em;
}

/* ===== Bar ===== */
.kgents-bar {
  display: inline-block;
  font-family: var(--kgents-font-mono);
  letter-spacing: 0;
}

.kgents-bar-vertical {
  display: flex;
  flex-direction: column;
  line-height: 1;
}

.kgents-bar-container {
  display: flex;
  align-items: center;
  gap: 4px;
}

.kgents-bar-label {
  color: var(--kgents-text-muted);
  font-size: 0.85em;
}

.kgents-capability-bar {
  opacity: 0.85;
  letter-spacing: -1px;
}

/* ===== Glyph ===== */
.kgents-glyph {
  display: inline-block;
  font-family: var(--kgents-font-mono);
  transition: transform 0.1s ease;
}

/* Glyph animations */
.kgents-glyph-pulse {
  animation: kgents-glyph-pulse 1s ease-in-out infinite;
}

@keyframes kgents-glyph-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.1); }
}

.kgents-glyph-blink {
  animation: kgents-glyph-blink 0.8s step-end infinite;
}

@keyframes kgents-glyph-blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

.kgents-glyph-breathe {
  animation: kgents-glyph-breathe 2s ease-in-out infinite;
}

@keyframes kgents-glyph-breathe {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

.kgents-glyph-wiggle {
  animation: kgents-glyph-wiggle 0.5s ease-in-out infinite;
}

@keyframes kgents-glyph-wiggle {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-3deg); }
  75% { transform: rotate(3deg); }
}

/* ===== Yield Card ===== */
.kgents-yield-card {
  background: var(--kgents-surface);
  border: 1px dashed var(--kgents-surface-border);
  border-radius: 4px;
  padding: 8px 12px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.kgents-yield-card.kgents-yield-pending {
  opacity: 0.7;
}

.kgents-yield-card.kgents-yield-in_progress {
  border-color: var(--kgents-primary);
}

.kgents-yield-card.kgents-yield-complete {
  border-color: var(--kgents-success);
  border-style: solid;
}

.kgents-yield-card.kgents-yield-error {
  border-color: var(--kgents-error);
}

.kgents-yield-header {
  font-weight: 500;
}

.kgents-yield-progress {
  animation: kgents-spin 1s linear infinite;
}

@keyframes kgents-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ===== H-gent Card ===== */
.kgents-hgent-card {
  background: linear-gradient(135deg, var(--kgents-surface), rgba(59, 130, 246, 0.1));
  border: 1px solid var(--kgents-surface-border);
  border-radius: 4px;
  padding: 8px 12px;
  display: inline-block;
}

.kgents-hgent-header {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 500;
}

.kgents-hgent-icon {
  opacity: 0.7;
}

.kgents-hgent-type {
  font-size: 0.8em;
  color: var(--kgents-text-muted);
  margin-top: 4px;
}

/* ===== Generic JSON ===== */
.kgents-generic {
  background: var(--kgents-surface);
  border: 1px solid var(--kgents-surface-border);
  border-radius: 4px;
  padding: 8px;
  font-size: 0.85em;
  overflow-x: auto;
  max-width: 400px;
  max-height: 200px;
  margin: 0;
}
