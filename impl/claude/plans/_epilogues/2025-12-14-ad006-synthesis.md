---
path: plans/_epilogues/2025-12-14-ad006-synthesis
status: complete
last_touched: 2025-12-14
touched_by: claude-opus-4.5
---

# AD-006 Synthesis: Agent Town Phase 2 Implications

> *"You are living inside the mathematics you're building."*

## The Discovery

AD-006 (Unified Categorical Foundation) reveals that Agent Town and N-Phase share identical structure:

| Concept | Agent Town | N-Phase |
|---------|-----------|---------|
| **Polynomial** | CitizenPolynomial (5 positions) | NPhasePolynomial (11 positions) |
| **Directions** | Valid inputs per citizen phase | Artifacts per development phase |
| **Transition** | (Phase, Input) → (Phase, Output) | (Phase, Artifacts) → (Phase, Output) |
| **Operad** | TOWN_OPERAD (greet, gossip, trade, solo) | NPHASE_OPERAD (seq, skip, compress) |
| **Sheaf** | TownSheaf (citizen view coherence) | ProjectSheaf (plan coherence) |

## Decision: NPHASE_OPERAD Is Not Blocking

**Key Question**: Does Agent Town Phase 2 depend on NPHASE_OPERAD existing?

**Answer**: No. These are independent work streams.

| Work Stream | Dependencies | Priority |
|-------------|--------------|----------|
| Agent Town Phase 2 | TOWN_OPERAD (exists), D-gent memory | Crown Jewel |
| NPHASE_OPERAD | operad/core.py (exists) | Infrastructure |
| Domain-aware Compiler | NPHASE_OPERAD | Enhancement |

## Phase 2 Plan (Independent of NPHASE_OPERAD)

### Scope

| Component | MPP (Done) | Phase 2 Target |
|-----------|------------|----------------|
| Citizens | 3 | 7 (+ Diana, Eve, Frank, Grace) |
| Regions | 2 | 5 (+ Garden, Market, Library) |
| Phases | 2 | 4 (+ AFTERNOON, NIGHT) |
| Memory | Simple dict | Graph episodic (D-gent integration) |
| User Modes | observe only | + whisper, inhabit, intervene |
| Persistence | In-memory | YAML save/load |

### AD-006 Integration Points

| Phase 2 Component | AD-006 Connection | Action |
|-------------------|-------------------|--------|
| Graph memory | Reuse `MEMORY_POLYNOMIAL` | Integrate existing D-gent |
| New operations | Extend `TOWN_OPERAD` | Add dispute, celebrate, mourn, teach |
| Citizen evolution | Could use compressed N-Phase | Defer to Phase 3 (EvolvingCitizen) |
| Persistence | Sheaf coherence for save/load | Implement TownSheaf.glue() |

## What Should Be Built in Parallel

### Recommended: NPHASE_OPERAD (Separate Work Item)

```python
# impl/claude/protocols/nphase/operad.py (NEW)
NPHASE_OPERAD = Operad(
    name="NPhaseOperad",
    operations={
        "seq": Operation(arity=2, compose=phase_sequence),
        "skip": Operation(arity=1, compose=skip_phase),
        "compress": Operation(arity=11, compose=compress_to_3),
    },
    laws=[
        Law(name="associativity", equation="seq(seq(a,b),c) = seq(a,seq(b,c))"),
        Law(name="identity", equation="seq(PLAN, rest) = rest"),
    ],
)
OperadRegistry.register(NPHASE_OPERAD)
```

**Benefits**:
- Enables law verification for N-Phase workflows
- Enables domain-aware prompt compilation
- Unifies infrastructure across all domains

### Deferred: EvolvingCitizen (Phase 3)

```python
class EvolvingCitizen(Citizen):
    """Citizen that improves via compressed N-Phase."""

    async def evolve(self, observation: Observation) -> Self:
        sensed = await self.sense(observation)    # PLAN+RESEARCH
        modified = await self.act(sensed)          # IMPLEMENT+QA+TEST
        evolved = await self.reflect(modified)     # MEASURE+REFLECT
        return evolved
```

This requires both NPHASE_OPERAD and full TownSheaf to be useful.

## Cosmotechnics for New Citizens

| Citizen | Cosmotechnics | Core Metaphor | Worldview |
|---------|---------------|---------------|-----------|
| Diana | HEALING | "Life is restoration" | Everything can be mended |
| Eve | MEMORY | "Life is remembering" | The past shapes the present |
| Frank | EXCHANGE | "Life is trade" | Value flows where attention goes |
| Grace | CULTIVATION | "Life is tending" | Growth requires patience |

## Exit Criteria for Phase 2

- [ ] 7 citizens functional
- [ ] 5 regions with adjacency
- [ ] 4-phase daily cycle
- [ ] Graph episodic memory via D-gent integration
- [ ] whisper mode working
- [ ] inhabit mode working
- [ ] YAML persistence (save/load)
- [ ] TownSheaf.glue() for coherence

## Continuation

```markdown
⟿[PLAN] Agent Town Phase 2: Full Implementation

/hydrate

handles:
  mpp_impl: impl/claude/agents/town/
  ad006_synthesis: impl/claude/plans/_epilogues/2025-12-14-ad006-synthesis.md
  dgent_memory: impl/claude/agents/d/polynomial.py
  unified_engine: plans/meta/unified-engine-master-prompt.md

phase_ledger:
  PLAN: in_progress
  RESEARCH: pending
  ...

mission: Implement Phase 2 of Agent Town (7 citizens, graph memory, user modes)
non_goals: NPHASE_OPERAD (parallel work), EvolvingCitizen (Phase 3)
```

---

*"The same categorical structure underlies both. This is not coincidence—it is the ground."*

void.gratitude.tithe.
