# CREATIVE Offerings — Run 028

**Updated**: 2025-12-27T19:54:00

---

## Summary (Iterations 1-2)

✅ **DD-21**: Pattern-Based Enemy Behaviors — Refactor target selected
✅ **DD-22**: Telegraph Visual System — Color-coded attack indicators
✅ **DD-23**: Attack Timing Constants — 3-phase timing model
✅ **DD-24**: Spitter Enemy Type — New ranged enemy

See `.outline.md` for full specifications.

---

## Iteration 3 Offerings: Architecture

### Enemy Behavior State Machine

```typescript
type EnemyState =
  | 'idle'        // Default, transitioning
  | 'chase'       // Moving toward player
  | 'flee'        // Moving away (Spitter)
  | 'telegraph'   // Wind-up animation
  | 'attack'      // Executing attack
  | 'recovery';   // Post-attack vulnerability

interface EnemyBehavior {
  state: EnemyState;
  stateTimer: number;      // ms in current state
  targetPosition: Vector2 | null;
  attackPattern: AttackPattern | null;
}

interface AttackPattern {
  type: 'lunge' | 'charge' | 'stomp' | 'projectile' | 'combo';
  telegraphDuration: number;
  attackDuration: number;
  recoveryDuration: number;
  // Attack-specific data
  chargeDirection?: Vector2;
  stompRadius?: number;
  projectileTarget?: Vector2;
}
```

### Integration Points

**spawn.ts**: Add 'spitter' to EnemyType, spawn with behavior state
**physics.ts**: Process enemy state transitions, handle attack logic
**juice.ts**: Add telegraph particle effects
**GameCanvas.tsx**: Render telegraphs (ground markers, aim lines)
**useGameLoop.ts**: Enemy attack damage (separate from contact damage)

### Telegraph Rendering

```typescript
interface TelegraphVisual {
  type: 'glow' | 'line' | 'circle' | 'laser';
  color: string;
  progress: number;  // 0-1, for animation
  // Type-specific
  radius?: number;   // For circle
  start?: Vector2;   // For line/laser
  end?: Vector2;
}
```

### New File: systems/enemies.ts

```
Purpose: Enemy behavior state machine + attack patterns
Exports:
  - updateEnemyBehavior(enemy, player, deltaTime): Enemy
  - getEnemyTelegraph(enemy): TelegraphVisual | null
  - processEnemyAttack(enemy, player): DamageEvent | null
  - ENEMY_PATTERNS: Record<EnemyType, AttackPattern>
```

---

## What I Need

- ADVERSARIAL: Code review when implementation starts (iteration 4)
- PLAYER: Playtest when .build.ready (iteration 8)
