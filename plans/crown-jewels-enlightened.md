---
path: plans/crown-jewels-enlightened
status: active
progress: 0
last_touched: 2025-12-16
touched_by: claude-opus-4-5
blocking: []
enables:
  - ALL crown jewel work
session_notes: |
  This document consolidates and replaces:
  - plans/core-apps-synthesis.md (original plan)
  - plans/crown-jewels-strategy-refresh.md (critical analysis)
  - plans/crown-jewels-audit-strategy.md (audit)
  - plans/crown-jewel-improvements/* (12 improvement plans)

  The insight: 7 parallel experiments = 0 production experiences.
  The pivot: Convergent Crown strategy with hero paths.
phase_ledger:
  PLAN: complete
  RESEARCH: pending
  DEVELOP: pending
  IMPLEMENT: pending
  REFLECT: pending
entropy:
  planned: 1.0
  spent: 0.0
  returned: 0.0
---

# The Enlightened Crown: A Radical Restructuring

> *"The Crown is not 7 apps—it is 1 engine with 7 experience modes."*
> *But first, it must be 1 engine with 1 undeniable experience.*

---

## I. The Reckoning

### What We Built
- 559 AGENTESE tests
- 58 registered paths
- 16 production systems
- Polynomial agents, operads, sheaves
- A beautiful categorical engine

### What We Didn't Build
- A "wow moment" anyone can experience in 5 minutes
- Observer-dependent perception users can SEE
- Cross-jewel synergies that feel automatic
- Joy in the interaction (Principle 4 unfulfilled)
- AGENTESE paths users can learn and compose

### The Core Problem

**We built impressive infrastructure for builders, not experiences for users.**

The mathematical elegance is hidden. The categorical guarantees are invisible. Users interact with 7 half-finished apps that feel like internal tooling rather than 1 unified engine with 7 beautiful lenses.

---

## II. The Pivot: Convergent Crown Strategy

### From This (Parallel Scatter)

```
     ┌─ Atelier ─────────────── 40% done
     ├─ Coalition ───────────── 30% done
     ├─ Brain ───────────────── 60% done
     ├─ Park ────────────────── 20% done
ALL ─┼─ Domain ──────────────── 15% done
     ├─ Gestalt ─────────────── 55% done
     └─ Gardener ────────────── 35% done

     Result: 7 incomplete experiences
```

### To This (Convergent Funnel)

```
TIER 1: The Hero Path (100% Complete)
┌────────────────────────────────────────────────────────┐
│  Brain + Gestalt + Gardener                            │
│  "Understand, Remember, Grow"                          │
│                                                        │
│  This is the path. Every user experiences this first.  │
│  It demonstrates AGENTESE, observer-perception,        │
│  polynomial state, and cross-jewel synergy.            │
└────────────────────────────────────────────────────────┘
           │
           │ enables
           ▼
TIER 2: The Extension Paths (After Tier 1)
┌────────────────────┐  ┌────────────────────┐
│  Atelier           │  │  Coalition         │
│  "Create"          │  │  "Collaborate"     │
│                    │  │                    │
│  Uses Brain for    │  │  Uses Brain for    │
│  memory, Gestalt   │  │  context, Gardener │
│  for code analysis │  │  for orchestration │
└────────────────────┘  └────────────────────┘
           │                      │
           │ enables              │
           ▼                      ▼
TIER 3: The Full Expression (After Tier 2)
┌────────────────────────────────────────────────────────┐
│  Park + Domain                                         │
│  "Inhabit, Simulate"                                   │
│                                                        │
│  Full immersive experiences built on complete stack    │
└────────────────────────────────────────────────────────┘
```

---

## III. Tier 1: The Hero Path

### The Mission
Create ONE undeniable experience that proves everything:
- AGENTESE works (and users can see it)
- Observer-dependent perception is real (and users can feel it)
- Polynomial state machines are beautiful (and users can navigate them)
- Cross-jewel synergy is automatic (and users benefit without thinking)

### The Three Jewels

#### 1. Holographic Brain (self.memory.*)
**Why Hero**: Memory is universal. Everyone understands remembering.

**The Experience**:
```
kg brain capture "https://article.com"
[self.memory.capture] → Crystallizing...

✓ Crystal formed: "AI Code Assistants 2025"
  ├── Auto-linked to: 3 related memories
  ├── Observer: default (technical summary)
  └── Try: kg brain manifest --observer=casual
```

**What It Proves**:
- AGENTESE paths work (`self.memory.*`)
- Observer-dependent perception (same crystal, different views)
- Automatic synergy (links without asking)

#### 2. Gestalt Visualizer (world.codebase.*)
**Why Hero**: Developers care about their code. Show them something about it.

**The Experience**:
```
kg gestalt analyze impl/claude/
[world.codebase.manifest] → Scanning...

CODEBASE HEALTH: B+ (84/100)
┌────────────────────────────────────────────────────────┐
│                    ●                                    │
│           ●    ●       ●                               │
│      ●              ●      ●                           │
│                  ●                                      │
│    modules          dependencies          health       │
└────────────────────────────────────────────────────────┘

Drift violations: 2 (minor)
[View in 3D] [Export report] [Form refactoring team]
```

**What It Proves**:
- Immediate value (useful from minute 1)
- Visual beauty (topology is stunning)
- Cross-jewel tease ("Form refactoring team" → Coalition preview)

#### 3. The Gardener (concept.gardener.*)
**Why Hero**: This IS kgents talking to Kent. The autopoietic interface.

**The Experience**:
```
kg
[concept.gardener.manifest] → Welcome back, Kent.

┌─ SESSION STATE ────────────────────────────────────────┐
│                                                        │
│  ○─────●─────○─────○─────○─────○                       │
│  PLAN  RESEARCH                                        │
│        ↑ you are here                                  │
│                                                        │
│  Recent Brain crystals: 3 relevant                     │
│  Gestalt status: impl/claude/ healthy (B+)            │
│                                                        │
│  What would you like to explore?                       │
└────────────────────────────────────────────────────────┘
```

**What It Proves**:
- Polynomial state is visible (N-Phase diagram)
- Cross-jewel integration (Brain + Gestalt context)
- The Gardener orchestrates everything

### Hero Path Integration

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          THE HERO PATH FLOW                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  USER STARTS                                                                 │
│       │                                                                      │
│       ▼                                                                      │
│  ┌─────────┐    captures     ┌─────────┐    analyzes    ┌─────────┐        │
│  │  Brain  │ ◄──────────────│ Gestalt │ ◄─────────────│ Gardener │        │
│  │         │                 │         │                │          │        │
│  │ Memory  │    provides     │  Code   │    context     │   Meta   │        │
│  │ Store   │ ───────────────▶│ Analysis│ ──────────────▶│ Interface│        │
│  └─────────┘    context      └─────────┘    for         └─────────┘        │
│       │                            │                          │             │
│       │                            │                          │             │
│       └────────────────────────────┴──────────────────────────┘             │
│                          ALL SYNCED VIA AGENTESE                            │
│                                                                              │
│  DEMO PATH:                                                                  │
│  1. kg gestalt analyze .     → See your codebase health                     │
│  2. kg brain capture <url>   → Capture research                             │
│  3. kg gardener              → Orchestrate development session               │
│                                                                              │
│  TIME TO VALUE: 2 minutes                                                    │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## IV. The Critical Infrastructure

Before Tier 1 jewels can shine, we need these cross-cutting foundations:

### Foundation 1: Observer-Dependent Perception UI

**The Problem**: Users invoke paths but never see that different observers get different results.

**The Solution**: Every response shows observer context + offers switching.

```
┌─ CRYSTAL MANIFEST ──────────────────────────────────────────────────────────┐
│ Path: self.memory.crystal[abc].manifest                                     │
│ Observer: technical (current)                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  "Understanding Transformer Architecture"                                    │
│                                                                              │
│  Key Points:                                                                 │
│  • Self-attention mechanisms compute weighted relationships                 │
│  • Positional encoding preserves sequence information                       │
│  • Multi-head attention enables parallel relationship modeling              │
│                                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ Switch observer: [technical ✓] [casual] [security] [creative]               │
└─────────────────────────────────────────────────────────────────────────────┘
```

**Implementation**: `ObserverSwitcher` component + `--observer` flag everywhere.

### Foundation 2: AGENTESE Path Visibility

**The Problem**: Users use `kg brain capture` but never learn `self.memory.capture`.

**The Solution**: Show the path on every invocation + enable direct path usage.

```
$ kg brain capture "https://example.com"

┌─ self.memory.capture ───────────────────────────────────────────────────────┐
│ Aspect: define                                                              │
│ Effects: CRYSTAL_FORMED, LINKS_CREATED                                      │
└─────────────────────────────────────────────────────────────────────────────┘

Capturing URL...
✓ Crystal formed: crystal-2025-12-16-a7b3

Tip: Invoke directly: kg self.memory.capture --url "..."
```

**Implementation**: `PathTrace` component + `display_path_header()` function.

### Foundation 3: Visible Polynomial State

**The Problem**: Users interact with state machines but never see them.

**The Solution**: Every polynomial agent gets a visual representation.

```
┌─ GARDENER SESSION STATE ────────────────────────────────────────────────────┐
│                                                                              │
│    ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐      │
│    │  PLAN  │───▶│RESEARCH│───▶│ DEVELOP│───▶│STRATEGZ│───▶│IMPLEMENT│     │
│    │        │    │   ★    │    │        │    │        │    │        │      │
│    └────────┘    └────────┘    └────────┘    └────────┘    └────────┘      │
│                       ↑                                                      │
│                  You are here                                                │
│                                                                              │
│    Available: [→ DEVELOP] [↩ PLAN]                                          │
└─────────────────────────────────────────────────────────────────────────────┘
```

**Implementation**: `PolynomialDiagram` component + backend serialization.

### Foundation 4: Cross-Jewel Synergy

**The Problem**: Jewels operate in isolation. No automatic data flow.

**The Solution**: Automatic synergies with visible notifications.

```
✓ Gestalt analysis complete
↳ Synergy: Architecture snapshot captured to Brain
↳ Crystal: "impl/claude/ architecture 2025-12-16"
```

**Implementation**: `SynergyEventBus` + automatic capture hooks.

### Foundation 5: Personality & Joy

**The Problem**: UIs are functional but lifeless. Principle 4 unfulfilled.

**The Solution**: Micro-interactions, empathetic errors, celebration moments.

```
// Healthy grades breathe
<Breathe intensity={0.5}>
  <HealthGrade grade="A+" />
</Breathe>

// Errors are empathetic
<EmpathyError
  type="network"
  title="Lost in the void..."
  subtitle="The connection wandered off. Let's bring it back."
  action="Reconnect"
/>

// Success is celebrated
celebrate(); // confetti on milestone completion
```

**Implementation**: Animation primitives + PersonalityLoading + EmpathyError.

---

## V. Execution Waves

### Wave 0: Foundation Sprint (1-2 weeks)

**Goal**: Ship the 5 foundations so Tier 1 jewels can shine.

| Task | Effort | Impact |
|------|--------|--------|
| `ObserverSwitcher` component | 3 days | Critical |
| Path visibility in CLI | 2 days | Critical |
| `PolynomialDiagram` component | 4 days | High |
| `SynergyEventBus` infrastructure | 3 days | High |
| Animation primitives (Breathe, Pop, Shake) | 2 days | Medium |

**Success Criteria**:
- [x] Any AGENTESE invocation shows its path (Foundation 1 - Path Visibility)
- [x] Observer switching works in Brain and Gestalt (Foundation 2 - ObserverSwitcher)
- [x] Gardener session shows polynomial state diagram (Foundation 3 - PolynomialDiagram)
- [x] At least one automatic synergy works (Gestalt → Brain) (Foundation 4 - SynergyEventBus)
- [x] Loading states have personality per jewel (Foundation 5 - Animation Primitives) ✓ 2025-12-16

### Wave 1: Hero Path Polish (2-3 weeks)

**Goal**: Make Brain + Gestalt + Gardener undeniably good.

#### Brain Completion
| Task | Status | Notes |
|------|--------|-------|
| Crystal capture (URL, file, text) | ✓ | Done |
| Topology visualization (3D) | ✓ | Done |
| Observer switching UI | TODO | Foundation 1 |
| Crystal detail with multiple views | TODO | Show how observers differ |
| Auto-linking with visible feedback | TODO | "Linked to: 3 crystals" |

#### Gestalt Completion
| Task | Status | Notes |
|------|--------|-------|
| Module analysis | ✓ | Done |
| Health grading | ✓ | Done |
| Drift detection | ✓ | Done |
| 3D topology visualization | TODO | Unify with Brain topology |
| Governance analysis UI | TODO | Show violations beautifully |
| Synergy to Brain | ✓ | Foundation 4 - Auto-capture architecture |

#### Gardener Completion
| Task | Status | Notes |
|------|--------|-------|
| N-Phase session tracking | ✓ | Done |
| CLI interface | Partial | Needs polish |
| Polynomial state visualization | TODO | Show the state machine |
| Brain/Gestalt context integration | TODO | Show relevant crystals |
| Session orchestration | TODO | Plan 07 |

**Success Criteria**:
- [ ] New user can complete hero path in < 5 minutes
- [ ] Observer switching produces visibly different results
- [ ] Polynomial state is visible in Gardener
- [ ] Gestalt → Brain synergy works automatically
- [ ] At least one "wow moment" per jewel

### Wave 2: Tier 2 Enablement (2-3 weeks)

**Goal**: Atelier and Coalition work, built on Tier 1 foundation.

#### Atelier
- Uses Brain for memory (auto-capture creations)
- Uses Gestalt for code analysis (analyze artifacts)
- Bidding system with eigenvector personality

#### Coalition
- Uses Brain for context (query relevant memories)
- Uses Gardener for orchestration (spawn coalitions from sessions)
- Formation visualization with cross-jewel data

**Success Criteria**:
- [ ] Atelier creation auto-captures to Brain
- [ ] Coalition queries Brain for relevant context
- [ ] Both jewels feel like extensions of Tier 1, not separate apps

### Wave 3: Tier 3 & Full Integration (3-4 weeks)

**Goal**: Park and Domain work, completing the Crown.

#### Park
- Uses Domain simulation timers
- Scenario inhabitation with polynomial state visible
- Character masks with eigenvector personalities

#### Domain
- Crisis simulation with full timer infrastructure
- Compliance drill scenarios
- Drill results auto-capture to Brain

**Success Criteria**:
- [ ] Park scenario can include Domain simulation elements
- [ ] Domain drill results appear in Brain automatically
- [ ] All 7 jewels feel like one unified system

---

## VI. The Shared UI Library

All waves depend on a unified component library.

### @kgents/jewel-ui

```
@kgents/jewel-ui/
├── components/
│   ├── cards/           # AgentCard, CrystalCard, TaskCard
│   ├── elastic/         # ElasticSplit, ElasticContainer, ElasticCard
│   ├── polynomial/      # PolynomialDiagram, PolynomialNode
│   ├── topology/        # TopologyCanvas (unified for Brain + Gestalt)
│   ├── presence/        # AvatarStack, CursorOverlay
│   ├── entropy/         # EntropyBalance, SerendipityCard
│   ├── loading/         # PersonalityLoading, Skeleton
│   ├── error/           # EmpathyError
│   ├── path/            # PathTrace, ObserverSwitcher
│   └── animations/      # Breathe, Pop, Shake, Shimmer
├── hooks/
│   ├── useAgentStream.ts
│   ├── useObserverState.ts
│   ├── usePolynomialState.ts
│   └── useMotionPreferences.ts
└── types/
    ├── jewel.ts
    ├── polynomial.ts
    └── observer.ts
```

**Migration**: Extract existing components, unify duplicates, add new foundations.

---

## VII. Success Metrics

### The Only Metric That Matters

> **Can a new user experience the "wow moment" in under 5 minutes?**

### Supporting Metrics

| Metric | Target | How to Measure |
|--------|--------|----------------|
| Hero path completion | < 5 minutes | Time from install to first synergy |
| Path visibility | 100% | All CLI commands show AGENTESE path |
| Observer switching | 3+ observers | Default + 2 domain-specific per jewel |
| Polynomial visibility | 100% | All state machines have diagrams |
| Cross-jewel synergies | 5+ automatic | Brain captures from all jewels |
| User-reported delight | 70%+ | Survey after first session |

---

## VIII. What We're NOT Doing

### Explicitly Deprioritized

1. **Perfect feature parity across jewels** - Tier 1 gets all features, Tier 3 gets core features
2. **Advanced Park scenarios** - Until Tier 1 is solid
3. **Full Domain compliance library** - Ship with 2-3 drill templates
4. **marimo projections** - CLI + Web first
5. **Multi-tenant SaaS deployment** - Single-user experience first
6. **Enterprise features (audit, SSO)** - After product-market fit

### Technical Debt We Accept

1. Some duplication between jewels (mitigate with shared library)
2. Not all paths have handlers yet (focus on hero path paths)
3. OTEL coverage < 95% (prioritize user-facing features)

---

## IX. The Mirror Test

> *"Does K-gent feel like me on my best day?"*

### Checklist

- [ ] **Tasteful**: Does the Hero Path feel curated, not sprawling?
- [ ] **Joy-inducing**: Do the animations and feedback spark delight?
- [ ] **Composable**: Can I chain AGENTESE paths? (`brain capture | gestalt analyze`)
- [ ] **Observer-dependent**: Do I see different things from different perspectives?
- [ ] **Autopoietic**: Does the Gardener help me evolve kgents itself?
- [ ] **Categorical**: Is the math visible, not just infrastructure?

---

## X. Consolidated from Previous Plans

This document supersedes and incorporates:

### From core-apps-synthesis.md
- The 7 jewel taxonomy (preserved, now tiered)
- AGENTESE path assignments (preserved)
- Unified categorical foundation (preserved, now visible)

### From crown-jewels-strategy-refresh.md
- "7 parallel experiments = 0 production experiences" (adopted)
- Convergent funnel strategy (adopted)
- Hero path concept (adopted and extended)

### From crown-jewels-audit-strategy.md
- 12 improvement plans (incorporated as foundations)
- "Magical math is hidden" critique (addressed via visibility foundations)
- Cross-jewel synergy gaps (addressed via SynergyEventBus)

### From crown-jewel-improvements/*
- Plan 01: Observer Perception UI → Foundation 1
- Plan 02: First Five Minutes → Hero Path design
- Plan 03: Unified Streaming → @kgents/jewel-ui hooks
- Plan 04: Realtime Presence → Wave 2+ (deprioritized)
- Plan 05: Visible Polynomial → Foundation 3
- Plan 06: Unified Topology → @kgents/jewel-ui TopologyCanvas
- Plan 07: Gardener Orchestration → Wave 1 Gardener completion
- Plan 08: AGENTESE Visibility → Foundation 2
- Plan 09: Personality Micro-interactions → Foundation 5
- Plan 10: Entropy Budget → Wave 3 (deprioritized)
- Plan 11: Shared Jewel UI → @kgents/jewel-ui package
- Plan 12: Cross-Jewel Synergies → Foundation 4

---

## XI. Next Session Instructions

```
CROWN JEWEL EXECUTOR: Read this file and begin Wave 0.

Priority order:
1. Path visibility in CLI (Foundation 2) - Quick win, immediate impact
2. ObserverSwitcher component (Foundation 1) - Core differentiator
3. PolynomialDiagram component (Foundation 3) - Visual wow moment
4. SynergyEventBus (Foundation 4) - Cross-jewel magic
5. Animation primitives (Foundation 5) - Joy layer

After Wave 0, proceed to Wave 1: Hero Path Polish.

Success = New user experiences "wow moment" in < 5 minutes.
```

---

*"The garden is not seven plants. It is one ecosystem with seven expressions."*

*Last updated: 2025-12-16*
*Supersedes: core-apps-synthesis.md, crown-jewels-strategy-refresh.md, crown-jewels-audit-strategy.md*
